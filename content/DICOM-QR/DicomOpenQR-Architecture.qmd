---
title: "DicomOpenQR - Architecture Plan"
---


## 1. Solution Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DicomOpenQR Solution                                â”‚
â”‚                            (.NET 9 / C# 13)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                      DicomOpenQR.App                              â”‚     â”‚
â”‚   â”‚                    (MAUI Blazor Hybrid)                           â”‚     â”‚
â”‚   â”‚                                                                   â”‚     â”‚
â”‚   â”‚  â€¢ Razor Components (UI)                                          â”‚     â”‚
â”‚   â”‚  â€¢ MudBlazor Components                                           â”‚     â”‚
â”‚   â”‚  â€¢ Platform-specific code (if needed)                             â”‚     â”‚
â”‚   â”‚  â€¢ Dependency Injection setup                                     â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                               â”‚ references                                  â”‚
â”‚                               â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚                      DicomOpenQR.Core                             â”‚     â”‚
â”‚   â”‚                       (Class Library)                             â”‚     â”‚
â”‚   â”‚                                                                   â”‚     â”‚
â”‚   â”‚  â€¢ Domain Models                                                  â”‚     â”‚
â”‚   â”‚  â€¢ Service Interfaces & Implementations                           â”‚     â”‚
â”‚   â”‚  â€¢ DICOM Operations (fo-dicom)                                    â”‚     â”‚
â”‚   â”‚  â€¢ Excel Parsing                                                  â”‚     â”‚
â”‚   â”‚  â€¢ Anonymization Logic                                            â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Clean Architecture Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Clean Architecture Layers                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                     â”‚
    â”‚                          PRESENTATION                               â”‚
    â”‚                        (DicomOpenQR.App)                            â”‚
    â”‚                                                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚   â”‚   Pages/    â”‚  â”‚ Components/ â”‚  â”‚   ViewModels/StateContainersâ”‚ â”‚
    â”‚   â”‚  Razor      â”‚  â”‚  Shared UI  â”‚  â”‚   (if using MVVM pattern)   â”‚ â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                                                                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚ depends on
                                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                     â”‚
    â”‚                          APPLICATION                                â”‚
    â”‚                    (DicomOpenQR.Core/Application)                   â”‚
    â”‚                                                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚  Use Cases       â”‚  â”‚   Interfaces     â”‚  â”‚   DTOs           â”‚  â”‚
    â”‚   â”‚  (Orchestration) â”‚  â”‚  (Abstractions)  â”‚  â”‚  (Data Transfer) â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚ depends on
                                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                     â”‚
    â”‚                            DOMAIN                                   â”‚
    â”‚                    (DicomOpenQR.Core/Domain)                        â”‚
    â”‚                                                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚    Entities      â”‚  â”‚   Value Objects  â”‚  â”‚    Enums         â”‚  â”‚
    â”‚   â”‚  (Core Models)   â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â–²
                                   â”‚ implements interfaces from Application
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                     â”‚
    â”‚                        INFRASTRUCTURE                               â”‚
    â”‚                  (DicomOpenQR.Core/Infrastructure)                  â”‚
    â”‚                                                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚  DicomServices   â”‚  â”‚  ExcelService    â”‚  â”‚  FileSystem      â”‚  â”‚
    â”‚   â”‚  (fo-dicom)      â”‚  â”‚  (ClosedXML)     â”‚  â”‚  Services        â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Detailed Project Structure

```
DicomOpenQR/
â”‚
â”œâ”€â”€ DicomOpenQR.sln
â”‚
â”œâ”€â”€ src/
â”‚   â”‚
â”‚   â”œâ”€â”€ DicomOpenQR.Core/                      # Class Library
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Domain/                            # === DOMAIN LAYER ===
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ Entities/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ StudyRecord.cs             # Core study entity
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PatientMapping.cs          # AN â†’ Anonymized mapping
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ DicomInstance.cs           # Single DICOM file info
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ ValueObjects/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AccessionNumber.cs         # Strongly-typed AN
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AeTitle.cs                 # DICOM AE Title
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ DicomEndpoint.cs           # Host + Port + AE
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ Enums/
â”‚   â”‚   â”‚       â”œâ”€â”€ QueryStatus.cs             # Pending, Found, NotFound, Error
â”‚   â”‚   â”‚       â””â”€â”€ ProcessingStatus.cs        # Queued, Downloading, Anonymizing, Done
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Application/                       # === APPLICATION LAYER ===
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ Interfaces/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IDicomQueryService.cs      # C-FIND abstraction
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IDicomRetrieveService.cs   # C-MOVE abstraction
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IDicomStoreService.cs      # SCP (receive) abstraction
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IAnonymizationService.cs   # Anonymization abstraction
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IExcelReaderService.cs     # Excel parsing abstraction
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IFileExportService.cs      # Save files abstraction
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ IConfigurationService.cs   # App settings abstraction
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ DTOs/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ QueryRequestDto.cs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ QueryResultDto.cs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ExportOptionsDto.cs
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ PacsConfigDto.cs
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ UseCases/                      # Orchestration logic
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ QueryStudiesUseCase.cs     # Query multiple ANs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RetrieveStudiesUseCase.cs  # Download + Anonymize
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ExportMappingUseCase.cs    # Generate patient.csv
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ Events/                        # Progress events
â”‚   â”‚   â”‚       â”œâ”€â”€ QueryProgressEvent.cs
â”‚   â”‚   â”‚       â””â”€â”€ DownloadProgressEvent.cs
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ Infrastructure/                    # === INFRASTRUCTURE LAYER ===
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ Dicom/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FoDicomQueryService.cs     # IDicomQueryService impl
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FoDicomRetrieveService.cs  # IDicomRetrieveService impl
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FoDicomStoreService.cs     # SCP server impl
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ DicomAnonymizer.cs         # IAnonymizationService impl
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ Excel/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ClosedXmlReaderService.cs  # IExcelReaderService impl
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ FileSystem/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ LocalFileExportService.cs  # IFileExportService impl
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ Configuration/
â”‚   â”‚   â”‚       â””â”€â”€ JsonConfigurationService.cs
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ DicomOpenQR.Core.csproj
â”‚   â”‚
â”‚   â””â”€â”€ DicomOpenQR.App/                       # MAUI Blazor Hybrid
â”‚       â”‚
â”‚       â”œâ”€â”€ Platforms/                         # Platform-specific
â”‚       â”‚   â”œâ”€â”€ Android/
â”‚       â”‚   â”œâ”€â”€ iOS/
â”‚       â”‚   â”œâ”€â”€ MacCatalyst/
â”‚       â”‚   â””â”€â”€ Windows/
â”‚       â”‚
â”‚       â”œâ”€â”€ Components/                        # === PRESENTATION LAYER ===
â”‚       â”‚   â”‚
â”‚       â”‚   â”œâ”€â”€ Layout/
â”‚       â”‚   â”‚   â”œâ”€â”€ MainLayout.razor
â”‚       â”‚   â”‚   â””â”€â”€ NavMenu.razor
â”‚       â”‚   â”‚
â”‚       â”‚   â”œâ”€â”€ Pages/
â”‚       â”‚   â”‚   â”œâ”€â”€ Home.razor                 # Dashboard / main workflow
â”‚       â”‚   â”‚   â”œâ”€â”€ Settings.razor             # PACS configuration
â”‚       â”‚   â”‚   â”œâ”€â”€ QueryPage.razor            # Import Excel + Query
â”‚       â”‚   â”‚   â””â”€â”€ ResultsPage.razor          # Download progress + Export
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ Shared/
â”‚       â”‚       â”œâ”€â”€ StudyTable.razor           # MudTable for studies
â”‚       â”‚       â”œâ”€â”€ ProgressIndicator.razor    # Download progress
â”‚       â”‚       â”œâ”€â”€ FileDropZone.razor         # Excel upload
â”‚       â”‚       â””â”€â”€ ConnectionStatus.razor     # PACS connectivity
â”‚       â”‚
â”‚       â”œâ”€â”€ Services/
â”‚       â”‚   â””â”€â”€ AppStateService.cs             # UI state management
â”‚       â”‚
â”‚       â”œâ”€â”€ wwwroot/
â”‚       â”‚   â”œâ”€â”€ css/
â”‚       â”‚   â”‚   â””â”€â”€ app.css
â”‚       â”‚   â””â”€â”€ index.html
â”‚       â”‚
â”‚       â”œâ”€â”€ MauiProgram.cs                     # DI configuration
â”‚       â”œâ”€â”€ MainPage.xaml                      # BlazorWebView host
â”‚       â”œâ”€â”€ App.xaml
â”‚       â””â”€â”€ DicomOpenQR.App.csproj
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ DicomOpenQR.Core.Tests/
â”‚   â””â”€â”€ DicomOpenQR.App.Tests/
â”‚
â””â”€â”€ docs/
    â””â”€â”€ architecture.md
```

---

## 4. Dependency Flow (Clean Architecture)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Dependency Flow Diagram                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    The arrows show "depends on" relationships.
    Inner layers know NOTHING about outer layers.

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                 â”‚
                    â”‚      DicomOpenQR.App            â”‚
                    â”‚      (Presentation)             â”‚
                    â”‚                                 â”‚
                    â”‚  â€¢ Razor Pages                  â”‚
                    â”‚  â€¢ MudBlazor Components         â”‚
                    â”‚  â€¢ DI Registration              â”‚
                    â”‚                                 â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ references
                                     â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                        â”‚
    â”‚                         DicomOpenQR.Core                               â”‚
    â”‚                                                                        â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚  Infrastructure/                                                â”‚  â”‚
    â”‚   â”‚                                                                 â”‚  â”‚
    â”‚   â”‚   FoDicomQueryService â”€â”€â”€â”€â”€â”                                    â”‚  â”‚
    â”‚   â”‚   ClosedXmlReaderService â”€â”€â”¼â”€â”€â”€â”€ implements â”€â”€â”€â”€â”               â”‚  â”‚
    â”‚   â”‚   LocalFileExportService â”€â”€â”˜                    â”‚               â”‚  â”‚
    â”‚   â”‚                                                 â”‚               â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                     â”‚                  â”‚
    â”‚                                                     â–¼                  â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚  Application/                                                   â”‚  â”‚
    â”‚   â”‚                                                                 â”‚  â”‚
    â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
    â”‚   â”‚   â”‚   Interfaces     â”‚â—„â”€â”€â”€â”€â”€â”‚       Use Cases              â”‚    â”‚  â”‚
    â”‚   â”‚   â”‚                  â”‚      â”‚                              â”‚    â”‚  â”‚
    â”‚   â”‚   â”‚ IDicomQuery...   â”‚      â”‚  QueryStudiesUseCase         â”‚    â”‚  â”‚
    â”‚   â”‚   â”‚ IExcelReader...  â”‚      â”‚  RetrieveStudiesUseCase      â”‚    â”‚  â”‚
    â”‚   â”‚   â”‚ IAnonymization...â”‚      â”‚  ExportMappingUseCase        â”‚    â”‚  â”‚
    â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
    â”‚   â”‚                                          â”‚                      â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                              â”‚                         â”‚
    â”‚                                              â–¼                         â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚  Domain/                                                        â”‚  â”‚
    â”‚   â”‚                                                                 â”‚  â”‚
    â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  â”‚
    â”‚   â”‚   â”‚  Entities    â”‚  â”‚ Value Objectsâ”‚  â”‚    Enums     â”‚          â”‚  â”‚
    â”‚   â”‚   â”‚              â”‚  â”‚              â”‚  â”‚              â”‚          â”‚  â”‚
    â”‚   â”‚   â”‚ StudyRecord  â”‚  â”‚ AccessionNum â”‚  â”‚ QueryStatus  â”‚          â”‚  â”‚
    â”‚   â”‚   â”‚ PatientMap   â”‚  â”‚ AeTitle      â”‚  â”‚ ProcessStatusâ”‚          â”‚  â”‚
    â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚
    â”‚   â”‚                                                                 â”‚  â”‚
    â”‚   â”‚              âš ï¸  NO EXTERNAL DEPENDENCIES HERE                  â”‚  â”‚
    â”‚   â”‚                  (Pure C# / .NET types only)                    â”‚  â”‚
    â”‚   â”‚                                                                 â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Key Interfaces (Application Layer)

```csharp
// === Application/Interfaces/IDicomQueryService.cs ===

public interface IDicomQueryService
{
    /// <summary>
    /// Query PACS for a study by Accession Number using C-FIND
    /// </summary>
    Task<QueryResultDto?> QueryByAccessionNumberAsync(
        string accessionNumber, 
        CancellationToken ct = default);
    
    /// <summary>
    /// Test connectivity to PACS server
    /// </summary>
    Task<bool> TestConnectionAsync(CancellationToken ct = default);
}

// === Application/Interfaces/IDicomRetrieveService.cs ===

public interface IDicomRetrieveService
{
    /// <summary>
    /// Retrieve study from PACS using C-MOVE
    /// </summary>
    Task<RetrieveResult> RetrieveStudyAsync(
        string studyInstanceUid,
        IProgress<RetrieveProgress>? progress = null,
        CancellationToken ct = default);
}

// === Application/Interfaces/IAnonymizationService.cs ===

public interface IAnonymizationService
{
    /// <summary>
    /// Anonymize a DICOM file and return anonymized version
    /// </summary>
    Task<AnonymizedResult> AnonymizeAsync(
        string inputPath,
        PatientMapping mapping,
        CancellationToken ct = default);
    
    /// <summary>
    /// Generate a new anonymous identifier
    /// </summary>
    string GenerateAnonymousId(string prefix = "ANON");
}

// === Application/Interfaces/IExcelReaderService.cs ===

public interface IExcelReaderService
{
    /// <summary>
    /// Read Accession Numbers from Excel file
    /// </summary>
    Task<IReadOnlyList<string>> ReadAccessionNumbersAsync(
        Stream excelStream,
        string columnName = "AN",
        CancellationToken ct = default);
}
```

---

## 6. Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Data Flow Overview                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    USER ACTION                     SYSTEM FLOW
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    1. Upload Excel
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Stream      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  FileDropZoneâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ IExcelReaderServiceâ”‚
    â”‚   (Razor)   â”‚                 â”‚  (ClosedXML)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                    List<AccessionNumber>
                                             â”‚
    2. Click "Query"                         â”‚
         â”‚                                   â”‚
         â–¼                                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  QueryPage  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ QueryStudiesUseCase  â”‚
    â”‚   (Razor)   â”‚               â”‚                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â”‚ for each AN
                                             â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚  IDicomQueryService  â”‚
                                  â”‚     (C-FIND)         â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                       â”‚   PACS   â”‚
                                       â”‚ (Orthanc)â”‚
                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                    List<StudyRecord>
                                             â”‚
    3. Click "Download"                      â”‚
         â”‚                                   â”‚
         â–¼                                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ResultsPage â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚RetrieveStudiesUseCaseâ”‚
    â”‚   (Razor)   â”‚               â”‚                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                   â”‚                   â”‚
                         â–¼                   â–¼                   â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚IDicomRetrieve   â”‚ â”‚ IDicomStore     â”‚ â”‚ IAnonymization  â”‚
              â”‚Service (C-MOVE) â”‚ â”‚ Service (SCP)   â”‚ â”‚ Service         â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                   â”‚                   â”‚
                       â–¼                   â–¼                   â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   PACS   â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚  Receive  â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ Anonymize â”‚
                  â”‚ (C-MOVE) â”‚       â”‚  DICOM    â”‚       â”‚  & Save   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â–¼
    4. Export                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                            â”‚  /output/       â”‚
         â–¼                                            â”‚  â”œâ”€â”€ patient.csvâ”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â””â”€â”€ DICOM/     â”‚
    â”‚ ResultsPage â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ IFileExport   â”‚â”€â”€â–¶â”‚      â””â”€â”€ ...    â”‚
    â”‚   (Razor)   â”‚               â”‚ Service       â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. DICOM SCP Architecture (Receive Studies)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DICOM SCP (Storage Class Provider)                       â”‚
â”‚                    Receives images via C-STORE                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    When the app sends C-MOVE to PACS, PACS will push images back
    via C-STORE. We need an SCP running to receive them.

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                        DicomOpenQR.App                              â”‚
    â”‚                                                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚   â”‚                    IDicomStoreService                         â”‚ â”‚
    â”‚   â”‚                    (Background Service)                       â”‚ â”‚
    â”‚   â”‚                                                               â”‚ â”‚
    â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
    â”‚   â”‚   â”‚              DicomServer (fo-dicom)                     â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚              Listening on port 11112                    â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚                                                         â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚  DicomCStoreProvider                            â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚                                                 â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚  OnCStoreRequest(DicomCStoreRequest request)    â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚  {                                              â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚      1. Receive DICOM file                      â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚      2. Look up mapping by StudyInstanceUID     â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚      3. Anonymize                               â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚      4. Save to output folder                   â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚      5. Update progress                         â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â”‚  }                                              â”‚   â”‚ â”‚ â”‚
    â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚ â”‚
    â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â”‚                              â–²                                      â”‚
    â”‚                              â”‚ C-STORE                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                              â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                              â”‚   PACS  â”‚
                              â”‚(Orthanc)â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Flow:
    â•â•â•â•â•

    1. App sends C-MOVE request to PACS
       â”Œâ”€â”€â”€â”€â”€â”  C-MOVE (StudyUID, destination=DICOM_QR)  â”Œâ”€â”€â”€â”€â”€â”€â”
       â”‚ App â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ PACS â”‚
       â””â”€â”€â”€â”€â”€â”˜                                           â””â”€â”€â”€â”€â”€â”€â”˜

    2. PACS looks up destination AE Title "DICOM_QR" â†’ App's IP:Port

    3. PACS sends images via C-STORE
       â”Œâ”€â”€â”€â”€â”€â”â—€â”€â”€â”€â”€â”€â”€â”€â”€ C-STORE (image 1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”Œâ”€â”€â”€â”€â”€â”€â”
       â”‚ App â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€ C-STORE (image 2) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ PACS â”‚
       â”‚ SCP â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€ C-STORE (image N) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â””â”€â”€â”€â”€â”€â”€â”˜
       â””â”€â”€â”€â”€â”€â”˜

    4. App's SCP receives, anonymizes, and saves each image
```

---

## 8. NuGet Packages

```xml
<!-- DicomOpenQR.Core.csproj -->
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

  <ItemGroup>
    <!-- DICOM Operations -->
    <PackageReference Include="fo-dicom" Version="5.1.3" />
    
    <!-- Excel Parsing -->
    <PackageReference Include="ClosedXML" Version="0.104.2" />
    
    <!-- CSV Export -->
    <PackageReference Include="CsvHelper" Version="33.0.1" />
    
    <!-- Logging -->
    <PackageReference Include="Microsoft.Extensions.Logging.Abstractions" Version="9.0.0" />
  </ItemGroup>
</Project>
```

```xml
<!-- DicomOpenQR.App.csproj -->
<Project Sdk="Microsoft.NET.Sdk.Razor">
  <PropertyGroup>
    <TargetFrameworks>net9.0-maccatalyst;net9.0-windows10.0.19041.0</TargetFrameworks>
    <OutputType>Exe</OutputType>
    <UseMaui>true</UseMaui>
    <SingleProject>true</SingleProject>
    <RootNamespace>DicomOpenQR.App</RootNamespace>
  </PropertyGroup>

  <ItemGroup>
    <!-- Blazor Hybrid -->
    <PackageReference Include="Microsoft.AspNetCore.Components.WebView.Maui" Version="9.0.0" />
    
    <!-- MudBlazor UI -->
    <PackageReference Include="MudBlazor" Version="7.15.0" />
    
    <!-- Project Reference -->
    <ProjectReference Include="..\DicomOpenQR.Core\DicomOpenQR.Core.csproj" />
  </ItemGroup>
</Project>
```

---

## 9. Orthanc Development Setup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Development Environment with Orthanc                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Your MacBook Pro (Development Machine)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                                                     â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚   DicomOpenQR.App   â”‚          â”‚        Orthanc              â”‚  â”‚
    â”‚   â”‚                     â”‚          â”‚      (PACS Server)          â”‚  â”‚
    â”‚   â”‚   AE Title:         â”‚          â”‚                             â”‚  â”‚
    â”‚   â”‚   DICOM_OPEN_QR     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   AE Title: ORTHANC         â”‚  â”‚
    â”‚   â”‚                     â”‚  DIMSE   â”‚   Port: 4242 (DICOM)        â”‚  â”‚
    â”‚   â”‚   SCP Port: 11112   â”‚          â”‚   Port: 8042 (Web UI)       â”‚  â”‚
    â”‚   â”‚                     â”‚          â”‚                             â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚            â”‚                                    â”‚                   â”‚
    â”‚            â”‚                                    â”‚                   â”‚
    â”‚            â–¼                                    â–¼                   â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚   ~/DicomOutput/    â”‚          â”‚   http://localhost:8042     â”‚  â”‚
    â”‚   â”‚   â”œâ”€â”€ patient.csv   â”‚          â”‚   (Upload test DICOM)       â”‚  â”‚
    â”‚   â”‚   â””â”€â”€ DICOM/        â”‚          â”‚                             â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                                                                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


    Orthanc Default Configuration (orthanc.json):
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    {
      "Name": "Orthanc",
      "DicomAet": "ORTHANC",
      "DicomPort": 4242,
      "HttpPort": 8042,
      
      // Register your app as a known modality
      "DicomModalities": {
        "DICOM_OPEN_QR": ["DICOM_OPEN_QR", "127.0.0.1", 11112]
      }
    }


    App Configuration (appsettings.json):
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    {
      "Pacs": {
        "Host": "127.0.0.1",
        "Port": 4242,
        "AeTitle": "ORTHANC"
      },
      "Local": {
        "AeTitle": "DICOM_OPEN_QR",
        "Port": 11112
      },
      "Output": {
        "BasePath": "~/DicomOutput"
      }
    }
```

---

## 10. UI Wireframe (MudBlazor)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DicomOpenQR                                              [â”€] [â–¡] [Ã—]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚  â”‚ ğŸ  Home  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚                                                         â”‚ â”‚
â”‚  â”‚ ğŸ“‹ Query â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚   â”‚  ğŸ“ Drop Excel file here or click to browse       â”‚ â”‚ â”‚
â”‚  â”‚ âš™ Settingsâ”‚  â”‚   â”‚                                                  â”‚ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚     Supported: .xlsx, .xls                        â”‚ â”‚ â”‚
â”‚                â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚                â”‚                                                         â”‚ â”‚
â”‚                â”‚   Found 5 Accession Numbers                             â”‚ â”‚
â”‚                â”‚                                                         â”‚ â”‚
â”‚                â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚                â”‚   â”‚ AN          â”‚ Status    â”‚ Modality â”‚ Date       â”‚   â”‚ â”‚
â”‚                â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”¤   â”‚ â”‚
â”‚                â”‚   â”‚ ACC001      â”‚ âœ… Found  â”‚ CT       â”‚ 2024-01-15 â”‚   â”‚ â”‚
â”‚                â”‚   â”‚ ACC002      â”‚ âœ… Found  â”‚ MR       â”‚ 2024-01-16 â”‚   â”‚ â”‚
â”‚                â”‚   â”‚ ACC003      â”‚ âŒ Not Foundâ”‚ -      â”‚ -          â”‚   â”‚ â”‚
â”‚                â”‚   â”‚ ACC004      â”‚ â³ Pending â”‚ -       â”‚ -          â”‚   â”‚ â”‚
â”‚                â”‚   â”‚ ACC005      â”‚ â³ Pending â”‚ -       â”‚ -          â”‚   â”‚ â”‚
â”‚                â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚                â”‚                                                         â”‚ â”‚
â”‚                â”‚   [ğŸ” Query PACS]  [â¬‡ï¸ Download & Anonymize]  [ğŸ“¤ Export]â”‚ â”‚
â”‚                â”‚                                                         â”‚ â”‚
â”‚                â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚                â”‚   â”‚ Progress: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60%             â”‚   â”‚ â”‚
â”‚                â”‚   â”‚ Downloading: ACC002 (45/120 images)             â”‚   â”‚ â”‚
â”‚                â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚                â”‚                                                         â”‚ â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŸ¢ Connected to ORTHANC @ 127.0.0.1:4242                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. Implementation Phases

```
Phase 1: Foundation (Week 1-2)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 â–¡ Create solution structure
 â–¡ Set up Domain entities and Value Objects
 â–¡ Define Application interfaces
 â–¡ Basic MudBlazor layout and navigation
 â–¡ Settings page with PACS configuration

Phase 2: DICOM Query (Week 3)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 â–¡ Implement IDicomQueryService with fo-dicom
 â–¡ Test C-FIND against Orthanc
 â–¡ Excel file parsing with ClosedXML
 â–¡ Query page UI with progress

Phase 3: DICOM Retrieve (Week 4-5)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 â–¡ Implement SCP (C-STORE receiver)
 â–¡ Implement C-MOVE request
 â–¡ Anonymization service
 â–¡ File export service

Phase 4: Polish & Package (Week 6)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 â–¡ Error handling and logging
 â–¡ CSV export (patient.csv)
 â–¡ Windows installer (Inno Setup or MSIX)
 â–¡ macOS packaging (.app bundle)
 â–¡ User documentation
```

---
